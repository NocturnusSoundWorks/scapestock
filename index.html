<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ScapeStock</title>
  <style>
     body {
    font-family: sans-serif;
    margin: 0;
    background: #f7f7f7;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
    h1 {
      text-align: center;
    }
    
    .gallery {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4枚並び */
    gap: 16px;
    max-width: 1000px;
    margin-top: 30px;
    justify-items: center;
  }

  .gallery img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 8px;
    max-width: 220px; /* 正方形を維持しつつ幅制限 */
  }

  @media screen and (max-width: 960px) {
    .gallery {
      grid-template-columns: repeat(2, 1fr); /* 小さい画面では2列 */
    }
  }

    /* モーダル全体の背景 */
.modal {
  display: none;
  position: fixed;
  z-index: 10;
  padding-top: 60px;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.8);
  justify-content: center;
  align-items: center;
}

/* 拡大画像 */
.modal-content {
  margin: auto;
  display: block;
  max-width: 70%;
  max-height: 70%;
  box-shadow: 0 0 20px #000;
  border-radius: 8px;
  transition: 0.3s;
  background: #fff;
}
  </style>
</head>
<body>
  <h1>ScapeStock</h1>
  <p style="text-align:center;">風景と都市スナップのフリー写真素材</p><br>
  
  <div style="margin: 20px 0; text-align: center;">
  <form onsubmit="filterImages(); return false;">
    <input
      type="text"
      id="searchInput"
      placeholder="画像を検索..."
      style="padding: 8px; width: 60%; max-width: 300px; font-size: 16px;"
    />
    <button
      type="submit"
      style="padding: 8px 16px; font-size: 16px; margin-left: 8px; background: #333; color: white; border: none; border-radius: 4px; cursor: pointer;"
    >
      検索
    </button>
  </form>
</div>

<form onsubmit="filterImages(); return false;">
  <input type="text" id="searchInput" placeholder="画像を検索..." style="padding: 8px; width: 60%; max-width: 300px; font-size: 16px;" />
  <button type="submit" style="padding: 8px 16px; font-size: 16px; margin-left: 8px;">検索</button>
</form>

  
 <div class="gallery">
  <img src="images/thu/25K062101_thu.jpg" alt="空　雲　太陽　青　白　景色　夏　昼">
  <img src="images/thu/25K062102_thu.jpg" alt="空　雲　青　白　景色　夏　昼">
  <img src="images/thu/25K062103_thu.jpg" alt="空　雲　青　葉　緑　景色　夏　昼">
  <img src="images/thu/25K062104_thu.jpg" alt="空　雲　青　白　景色　夏　昼">
  <img src="images/thu/25K062105_thu.jpg" alt="空　夕日　夜　景色">
  <img src="images/thu/25K062106_thu.jpg" alt="川　景色　東京 街　都会　昼　ビル">
  <img src="images/thu/25K062107_thu.jpg" alt="花　桜　葉　景色　白">
  <img src="images/thu/25K062108_thu.jpg" alt="花　紫陽花　あじさい　葉　景色　紫　青">
  <img src="images/thu/25K062109_thu.jpg" alt=""花　葉　草　景色　緑">
  <img src="images/thu/25K062110_thu.jpg" alt="花　葉　景色　赤">
  <img src="images/thu/25K062111_thu.jpg" alt="空　雲　青　白　景色　夏　昼">
  <img src="images/thu/25K062112_thu.jpg" alt="花　紫陽花　あじさい　葉　景色　紫　青">
  <img src="images/thu/25K062113_thu.jpg" alt="花　葉　景色　赤 オレンジ　黄">
  <img src="images/thu/25K062114_thu.jpg" alt="花　紫陽花　あじさい　葉　景色　紫　青">
  <img src="images/thu/25K062115_thu.jpg" alt="花　紫陽花　あじさい　葉　景色　紫　青">
  <img src="images/thu/25K062116_thu.jpg" alt="花　葉　景色　紫　白　青">
</div>
  <p style="text-align: center; margin-top: 40px;">
  <a href="terms.html" style="color: #333; text-decoration: underline;">利用規約はこちら</a>
</p>
  
<div id="modal" class="modal" onclick="closeModal(event)">
  <div style="text-align: center;">
    <img id="modalImg" class="modal-content" src="" alt="拡大画像">
    <p style="color: white; margin-top: 1em;">この画像をダウンロードしますか？</p>
    <a id="downloadBtn" href="#" download style="
      display: inline-block;
      padding: 10px 20px;
      background: #ffffff;
      color: #333;
      border-radius: 6px;
      text-decoration: none;
      font-weight: bold;
    ">
      ダウンロード
    </a>
  </div>
</div>

<script>
  // ✅ 初期表示：16枚だけ表示
  document.addEventListener("DOMContentLoaded", () => {
    const images = document.querySelectorAll('.gallery img');
    images.forEach((img, index) => {
      img.style.display = index < 16 ? '' : 'none';
    });

    // モーダル処理のイベント設定（初期表示と検索後に必要）
    setModalEvents();
  });

  // ✅ 検索機能（ボタン押下時に呼び出される）
  function filterImages() {
    const input = document.getElementById('searchInput').value.toLowerCase();
    const images = document.querySelectorAll('.gallery img');
    let anyMatch = false;

    images.forEach((img, index) => {
      const alt = img.alt.toLowerCase();
      if (alt.includes(input)) {
        img.style.display = '';
        anyMatch = true;
      } else {
        img.style.display = 'none';
      }
    });

    // 入力が空ならまた16枚に戻す
    if (input.trim() === "") {
      images.forEach((img, index) => {
        img.style.display = index < 16 ? '' : 'none';
      });
    }

    // 再検索後もモーダルを使えるようにイベント再登録
    setModalEvents();
  }

  // ✅ モーダル表示とDLボタン処理
  function setModalEvents() {
    document.querySelectorAll('.gallery img').forEach(img => {
      img.onclick = function () {
        const modal = document.getElementById('modal');
        const modalImg = document.getElementById('modalImg');
        const downloadBtn = document.getElementById('downloadBtn');

        modal.style.display = "flex";
        modalImg.src = this.src;
        modalImg.alt = this.alt;

        const thumbSrc = this.src;
        const fullSrc = thumbSrc.replace("thu/", "full/").replace("_thu", "");
        downloadBtn.href = fullSrc;
        downloadBtn.download = fullSrc.split('/').pop();
      };
    });
  }

  // ✅ モーダルを閉じる処理
  function closeModal(e) {
    if (e.target.id === 'modalImg' || e.target.id === 'downloadBtn') return;
    document.getElementById('modal').style.display = "none";
  }
</script>
</body>
</html>
